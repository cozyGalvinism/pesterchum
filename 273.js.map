{"version":3,"sources":["webpack://pesterchum/./node_modules/eventemitter3/index.js","webpack://pesterchum/./node_modules/fast-text-encoding/text.min.js","webpack://pesterchum/./node_modules/irc-framework/dist/browser/src/channel.js","webpack://pesterchum/./node_modules/irc-framework/dist/browser/src/client.js"],"names":["has","Object","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","exports","m","k","a","c","fatal","r","indexOf","toLowerCase","RangeError","Error","q","f","Math","min","e","Uint16Array","h","d","b","String","fromCharCode","subarray","join","g","n","TextEncoder","TextDecoder","defineProperty","value","encode","stream","max","Uint8Array","charCodeAt","set","p","Buffer","from","buffer","byteOffset","byteLength","toString","Blob","URL","createObjectURL","type","XMLHttpRequest","open","send","responseText","revokeObjectURL","decode","ArrayBuffer","window","global","_typeof","obj","Symbol","iterator","constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","key","require","_","partial","filter","find","each","pull","extend","DuplexStream","IrcChannel","irc_client","channel_name","_this","instance","Constructor","_classCallCheck","say","bind","notice","part","mode","banlist","ban","unban","users","channel","o","nick","kicked","new_nick","modes","network","options","PREFIX","user","u","param","protoProps","target_chan","opts","one_way","replay_nicks","this_stream","other_stream","pipe","stream_opts","_this2","read_queue","is_reading","objectMode","write","chunk","encoding","next","message","read","shift","_read","cb","_this3","updateUserList","raw","_toConsumableArray","arr","isArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","minLen","test","_unsupportedIterableToArray","_nonIterableSpread","arr2","_setPrototypeOf","setPrototypeOf","_possibleConstructorReturn","self","ReferenceError","_assertThisInitialized","_getPrototypeOf","getPrototypeOf","defer","MiddlewareHandler","IrcCommandHandler","IrcMessage","Connection","NetworkInfo","User","Channel","lineBreak","MessageTags","default_transport","_EventEmitter","subClass","superClass","_inherits","IrcClient","staticProps","Derived","hasNativeReflectConstruct","_super","Reflect","construct","sham","Proxy","Date","_isNativeReflectConstruct","result","Super","NewTarget","request_extra_caps","createStructure","transport","user_options","defaults","username","gecos","version","enable_chghost","enable_setname","enable_echomessage","auto_reconnect","auto_reconnect_wait","auto_reconnect_max_retries","ping_interval","ping_timeout","message_max_length","keys","client","raw_middleware","parsed_middleware","connection","command_handler","addCommandHandlerListeners","forEach","event_name","registerToNetwork","startPeriodicPing","cap","negotiating","requested","resetCache","raw_line","handle","command","err","console","log","stack","dispatch","away","proxyIrcEvents","get","connected","middleware_fn","_applyDefaultOptions","debugOut","end","requestExtraCaps","connect","event_arg","resetPingTimeoutTimer","reply","dest","error","commands","match","toggleModes","thisUser","ident","host","hostname","registeredSuccessfully","webirc","address","password","that","timeout_timer","pingTimeout","end_msg","rawString","clearTimeout","setTimeout","pingServer","ping","out","input","to1459","item","now","commandName","split","line","bytes","allowBreakingWords","allowBreakingGraphemes","block","sendMessage","tags","msg","_mode","extra_args","invex","supports","onInviteList","unbindEvents","onInviteListErr","mask","onBanlist","newTopic","params","toUpperCase","blockLength","blocks","ctcpRequest","_cb","irc_args","arg","onWhois","onWhowas","who_queue","processNextWhoQueue","is_running","this_who","onWho","cache","channels","unshift","match_regex","message_type","onMessage","stop"],"mappings":"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","file":"273.js","sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","(function(l){function m(){}function k(a,c){a=void 0===a?\"utf-8\":a;c=void 0===c?{fatal:!1}:c;if(-1===r.indexOf(a.toLowerCase()))throw new RangeError(\"Failed to construct 'TextDecoder': The encoding label provided ('\"+a+\"') is invalid.\");if(c.fatal)throw Error(\"Failed to construct 'TextDecoder': the 'fatal' option is unsupported.\");}function t(a){return Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString(\"utf-8\")}function u(a){var c=URL.createObjectURL(new Blob([a],{type:\"text/plain;charset=UTF-8\"}));\ntry{var f=new XMLHttpRequest;f.open(\"GET\",c,!1);f.send();return f.responseText}catch(e){return q(a)}finally{URL.revokeObjectURL(c)}}function q(a){for(var c=0,f=Math.min(65536,a.length+1),e=new Uint16Array(f),h=[],d=0;;){var b=c<a.length;if(!b||d>=f-1){h.push(String.fromCharCode.apply(null,e.subarray(0,d)));if(!b)return h.join(\"\");a=a.subarray(c);d=c=0}b=a[c++];if(0===(b&128))e[d++]=b;else if(192===(b&224)){var g=a[c++]&63;e[d++]=(b&31)<<6|g}else if(224===(b&240)){g=a[c++]&63;var n=a[c++]&63;e[d++]=\n(b&31)<<12|g<<6|n}else if(240===(b&248)){g=a[c++]&63;n=a[c++]&63;var v=a[c++]&63;b=(b&7)<<18|g<<12|n<<6|v;65535<b&&(b-=65536,e[d++]=b>>>10&1023|55296,b=56320|b&1023);e[d++]=b}}}if(l.TextEncoder&&l.TextDecoder)return!1;var r=[\"utf-8\",\"utf8\",\"unicode-1-1-utf-8\"];Object.defineProperty(m.prototype,\"encoding\",{value:\"utf-8\"});m.prototype.encode=function(a,c){c=void 0===c?{stream:!1}:c;if(c.stream)throw Error(\"Failed to encode: the 'stream' option is unsupported.\");c=0;for(var f=a.length,e=0,h=Math.max(32,\nf+(f>>>1)+7),d=new Uint8Array(h>>>3<<3);c<f;){var b=a.charCodeAt(c++);if(55296<=b&&56319>=b){if(c<f){var g=a.charCodeAt(c);56320===(g&64512)&&(++c,b=((b&1023)<<10)+(g&1023)+65536)}if(55296<=b&&56319>=b)continue}e+4>d.length&&(h+=8,h*=1+c/a.length*2,h=h>>>3<<3,g=new Uint8Array(h),g.set(d),d=g);if(0===(b&4294967168))d[e++]=b;else{if(0===(b&4294965248))d[e++]=b>>>6&31|192;else if(0===(b&4294901760))d[e++]=b>>>12&15|224,d[e++]=b>>>6&63|128;else if(0===(b&4292870144))d[e++]=b>>>18&7|240,d[e++]=b>>>12&\n63|128,d[e++]=b>>>6&63|128;else continue;d[e++]=b&63|128}}return d.slice?d.slice(0,e):d.subarray(0,e)};Object.defineProperty(k.prototype,\"encoding\",{value:\"utf-8\"});Object.defineProperty(k.prototype,\"fatal\",{value:!1});Object.defineProperty(k.prototype,\"ignoreBOM\",{value:!1});var p=q;\"function\"===typeof Buffer&&Buffer.from?p=t:\"function\"===typeof Blob&&\"function\"===typeof URL&&\"function\"===typeof URL.createObjectURL&&(p=u);k.prototype.decode=function(a,c){c=void 0===c?{stream:!1}:c;if(c.stream)throw Error(\"Failed to decode: the 'stream' option is unsupported.\");\na=a instanceof Uint8Array?a:a.buffer instanceof ArrayBuffer?new Uint8Array(a.buffer):new Uint8Array(a);return p(a)};l.TextEncoder=m;l.TextDecoder=k})(\"undefined\"!==typeof window?window:\"undefined\"!==typeof global?global:this);\n","'use strict';\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.array.join\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.function.bind\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.object.define-property\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar _ = {\n  partial: require('lodash/partial'),\n  filter: require('lodash/filter'),\n  find: require('lodash/find'),\n  each: require('lodash/each'),\n  pull: require('lodash/pull'),\n  extend: require('lodash/extend')\n};\n\nvar DuplexStream = require('stream').Duplex;\n\nmodule.exports = /*#__PURE__*/function () {\n  function IrcChannel(irc_client, channel_name, key) {\n    var _this = this;\n\n    _classCallCheck(this, IrcChannel);\n\n    this.irc_client = irc_client;\n    this.name = channel_name; // TODO: Proxy channel related events from irc_bot to this instance\n\n    this.say = _.partial(irc_client.say.bind(irc_client), channel_name);\n    this.notice = _.partial(irc_client.notice.bind(irc_client), channel_name); // this.action = _.partial(irc_client.action.bind(irc_client), channel_name);\n\n    this.part = _.partial(irc_client.part.bind(irc_client), channel_name);\n    this.join = _.partial(irc_client.join.bind(irc_client), channel_name);\n    this.mode = _.partial(irc_client.mode.bind(irc_client), channel_name);\n    this.banlist = _.partial(irc_client.banlist.bind(irc_client), channel_name);\n    this.ban = _.partial(irc_client.ban.bind(irc_client), channel_name);\n    this.unban = _.partial(irc_client.unban.bind(irc_client), channel_name);\n    this.users = [];\n    irc_client.on('userlist', function (event) {\n      if (event.channel.toLowerCase() === _this.name.toLowerCase()) {\n        _this.users = event.users;\n      }\n    });\n    irc_client.on('join', function (event) {\n      if (event.channel === _this.name) {\n        _this.users.push(event);\n      }\n    });\n    irc_client.on('part', function (event) {\n      if (event.channel === _this.name) {\n        _this.users = _.filter(_this.users, function (o) {\n          return o.nick.toLowerCase() !== event.nick.toLowerCase();\n        });\n      }\n    });\n    irc_client.on('kick', function (event) {\n      if (event.channel === _this.name) {\n        _this.users = _.filter(_this.users, function (o) {\n          return o.nick.toLowerCase() !== event.kicked.toLowerCase();\n        });\n      }\n    });\n    irc_client.on('quit', function (event) {\n      _this.users = _.filter(_this.users, function (o) {\n        return o.nick.toLowerCase() !== event.nick.toLowerCase();\n      });\n    });\n    irc_client.on('nick', function (event) {\n      _.find(_this.users, function (o) {\n        if (o.nick.toLowerCase() === event.nick.toLowerCase()) {\n          o.nick = event.new_nick;\n          return true;\n        }\n      });\n    });\n    irc_client.on('mode', function (event) {\n      /* event will be something like:\n      {\n          target: '#prawnsalad',\n          nick: 'ChanServ',\n          modes: [ { mode: '+o', param: 'prawnsalad' } ],\n          time: undefined\n      }\n      */\n      if (event.target.toLowerCase() !== _this.name.toLowerCase()) {\n        return;\n      } // There can be multiple modes set at once, loop through\n\n\n      _.each(event.modes, function (mode) {\n        // If this mode has a user prefix then we need to update the user object\n        // eg. +o +h +v\n        var user_prefix = _.find(irc_client.network.options.PREFIX, {\n          mode: mode.mode[1]\n        });\n\n        if (!user_prefix) {// TODO : manage channel mode changes\n        } else {\n          // It's a user mode\n          // Find the user affected\n          var user = _.find(_this.users, function (u) {\n            return u.nick.toLowerCase() === mode.param.toLowerCase();\n          });\n\n          if (!user) {\n            return;\n          }\n\n          if (mode.mode[0] === '+') {\n            user.modes = user.modes || [];\n            user.modes.push(mode.mode[1]);\n          } else {\n            _.pull(user.modes, mode.mode[1]);\n          }\n        }\n      });\n    });\n    this.join(key);\n  }\n  /**\n   * Relay messages between this channel to another\n   * @param  {IrcChannel|String} target_chan Target channel\n   * @param  {Object} opts        Extra options\n   *\n   * opts may contain the following properties:\n   * one_way (false) Only relay messages to target_chan, not the reverse\n   * replay_nicks (true) Include the sending nick as part of the relayed message\n   */\n\n\n  _createClass(IrcChannel, [{\n    key: \"relay\",\n    value: function relay(target_chan, opts) {\n      opts = _.extend({\n        one_way: false,\n        replay_nicks: true\n      }, opts);\n\n      if (typeof target_chan === 'string') {\n        target_chan = this.irc_client.channel(target_chan);\n      }\n\n      var this_stream = this.stream(opts);\n      var other_stream = target_chan.stream(opts);\n      this_stream.pipe(other_stream);\n\n      if (!opts.one_way) {\n        other_stream.pipe(this_stream);\n      }\n    }\n  }, {\n    key: \"stream\",\n    value: function stream(stream_opts) {\n      var _this2 = this;\n\n      var read_queue = [];\n      var is_reading = false;\n      var stream = new DuplexStream({\n        objectMode: true,\n        write: function write(chunk, encoding, next) {\n          // Support piping from one irc buffer to another\n          if (_typeof(chunk) === 'object' && typeof chunk.message === 'string') {\n            if (stream_opts.replay_nicks) {\n              chunk = '<' + chunk.nick + '> ' + chunk.message;\n            } else {\n              chunk = chunk.message;\n            }\n          }\n\n          _this2.say(chunk.toString());\n\n          next();\n        },\n        read: function read() {\n          is_reading = true;\n\n          while (read_queue.length > 0) {\n            var message = read_queue.shift();\n\n            if (stream.push(message) === false) {\n              is_reading = false;\n              break;\n            }\n          }\n        }\n      });\n      this.irc_client.on('privmsg', function (event) {\n        if (event.target.toLowerCase() === _this2.name.toLowerCase()) {\n          read_queue.push(event);\n\n          if (is_reading) {\n            stream._read();\n          }\n        }\n      });\n      return stream;\n    }\n  }, {\n    key: \"updateUsers\",\n    value: function updateUsers(cb) {\n      var _this3 = this;\n\n      var updateUserList = function updateUserList(event) {\n        if (event.channel.toLowerCase() === _this3.name.toLowerCase()) {\n          _this3.irc_client.removeListener('userlist', updateUserList);\n\n          if (typeof cb === 'function') {\n            cb(_this3);\n          }\n        }\n      };\n\n      this.irc_client.on('userlist', updateUserList);\n      this.irc_client.raw('NAMES', this.name);\n    }\n  }]);\n\n  return IrcChannel;\n}();","'use strict';\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.from\");\n\nrequire(\"core-js/modules/es.array.index-of\");\n\nrequire(\"core-js/modules/es.array.is-array\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.array.join\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.date.now\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.function.bind\");\n\nrequire(\"core-js/modules/es.function.name\");\n\nrequire(\"core-js/modules/es.object.create\");\n\nrequire(\"core-js/modules/es.object.define-property\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.reflect.construct\");\n\nrequire(\"core-js/modules/es.regexp.exec\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/es.string.match\");\n\nrequire(\"core-js/modules/es.string.split\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar _ = {\n  extend: require('lodash/extend'),\n  find: require('lodash/find'),\n  each: require('lodash/each'),\n  defer: require('lodash/defer'),\n  bind: require('lodash/bind')\n};\n\nvar EventEmitter = require('eventemitter3');\n\nvar MiddlewareHandler = require('middleware-handler');\n\nvar IrcCommandHandler = require('./commands/').CommandHandler;\n\nvar IrcMessage = require('./ircmessage');\n\nvar Connection = require('./connection');\n\nvar NetworkInfo = require('./networkinfo');\n\nvar User = require('./user');\n\nvar Channel = require('./channel');\n\nvar _require = require('./linebreak'),\n    lineBreak = _require.lineBreak;\n\nvar MessageTags = require('./messagetags');\n\nvar default_transport = null;\n\nmodule.exports = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(IrcClient, _EventEmitter);\n\n  var _super = _createSuper(IrcClient);\n\n  function IrcClient(options) {\n    var _this;\n\n    _classCallCheck(this, IrcClient);\n\n    _this = _super.call(this);\n    _this.request_extra_caps = [];\n    _this.options = options || null;\n\n    _this.createStructure();\n\n    return _this;\n  }\n\n  _createClass(IrcClient, [{\n    key: \"_applyDefaultOptions\",\n    value: function _applyDefaultOptions(user_options) {\n      var defaults = {\n        nick: 'ircbot',\n        username: 'ircbot',\n        gecos: 'ircbot',\n        encoding: 'utf8',\n        version: 'node.js irc-framework',\n        enable_chghost: false,\n        enable_setname: false,\n        enable_echomessage: false,\n        auto_reconnect: true,\n        auto_reconnect_wait: 4000,\n        auto_reconnect_max_retries: 3,\n        ping_interval: 30,\n        ping_timeout: 120,\n        message_max_length: 350,\n        transport: default_transport\n      };\n      var props = Object.keys(defaults);\n\n      for (var i = 0; i < props.length; i++) {\n        if (typeof user_options[props[i]] === 'undefined') {\n          user_options[props[i]] = defaults[props[i]];\n        }\n      }\n\n      return user_options;\n    }\n  }, {\n    key: \"createStructure\",\n    value: function createStructure() {\n      var client = this; // Provides middleware hooks for either raw IRC commands or the easier to use parsed commands\n\n      client.raw_middleware = new MiddlewareHandler();\n      client.parsed_middleware = new MiddlewareHandler();\n      client.connection = new Connection(client.options);\n      client.network = new NetworkInfo();\n      client.user = new User();\n      client.command_handler = new IrcCommandHandler(client.connection, client.network);\n      client.addCommandHandlerListeners(); // Proxy some connection events onto this client\n\n      ['connecting', 'reconnecting', 'close', 'socket close', 'socket error', 'raw socket connected', 'debug', 'raw'].forEach(function (event_name) {\n        client.connection.on(event_name, function () {\n          var args = Array.prototype.slice.call(arguments);\n          client.emit.apply(client, [event_name].concat(args));\n        });\n      });\n      client.connection.on('socket connected', function () {\n        client.emit('socket connected');\n        client.registerToNetwork();\n        client.startPeriodicPing();\n      });\n      client.connection.on('connecting', function () {\n        // Reset cap negotiation on a new connection\n        // This prevents stale state if a connection gets closed during CAP negotiation\n        client.network.cap.negotiating = false;\n        client.network.cap.requested = [];\n        client.command_handler.resetCache();\n      }); // IRC command routing\n\n      client.connection.on('message', function (message, raw_line) {\n        client.raw_middleware.handle([message.command, message, raw_line, client], function (err) {\n          if (err) {\n            console.log(err.stack);\n            return;\n          }\n\n          client.command_handler.dispatch(message);\n        });\n      });\n      client.on('away', function (event) {\n        if (event.nick.toLowerCase() === client.user.nick.toLowerCase()) {\n          client.user.away = true;\n        }\n      });\n      client.on('back', function (event) {\n        if (event.nick.toLowerCase() === client.user.nick.toLowerCase()) {\n          client.user.away = false;\n        }\n      }); // Proxy the command handler events onto the client object, with some added sugar\n\n      client.proxyIrcEvents();\n      Object.defineProperty(client, 'connected', {\n        enumerable: true,\n        get: function get() {\n          return client.connection && client.connection.connected;\n        }\n      });\n    }\n  }, {\n    key: \"requestCap\",\n    value: function requestCap(cap) {\n      this.request_extra_caps = this.request_extra_caps.concat(cap);\n    }\n  }, {\n    key: \"use\",\n    value: function use(middleware_fn) {\n      middleware_fn(this, this.raw_middleware, this.parsed_middleware);\n      return this;\n    }\n  }, {\n    key: \"connect\",\n    value: function connect(options) {\n      var client = this; // Use the previous options object if we're calling .connect() again\n\n      if (!options && !client.options) {\n        throw new Error('Options object missing from IrcClient.connect()');\n      } else if (!options) {\n        options = client.options;\n      } else {\n        client.options = options;\n      }\n\n      client._applyDefaultOptions(options);\n\n      if (client.connection && client.connection.connected) {\n        client.debugOut('connect() called when already connected');\n        client.connection.end();\n      }\n\n      client.user.nick = options.nick;\n      client.user.username = options.username;\n      client.user.gecos = options.gecos;\n      client.command_handler.requestExtraCaps(client.request_extra_caps); // Everything is setup and prepared, start connecting\n\n      client.connection.connect(options);\n    } // Proxy the command handler events onto the client object, with some added sugar\n    // Events are handled in order:\n    // 1. Received from the command handler\n    // 2. Checked if any extra properties/methods are to be added to the event + re-emitted\n    // 3. Routed through middleware\n    // 4. Emitted from the client instance\n\n  }, {\n    key: \"proxyIrcEvents\",\n    value: function proxyIrcEvents() {\n      var client = this;\n      this.command_handler.on('all', function (event_name, event_arg) {\n        client.resetPingTimeoutTimer(); // Add a reply() function to selected message events\n\n        if (['privmsg', 'notice', 'action'].indexOf(event_name) > -1) {\n          event_arg.reply = function (message) {\n            var dest = event_arg.target === client.user.nick ? event_arg.nick : event_arg.target;\n            client.say(dest, message);\n          }; // These events with .reply() function are all messages. Emit it separately\n          // TODO: Should this consider a notice a message?\n\n\n          client.command_handler.emit('message', _.extend({\n            type: event_name\n          }, event_arg));\n        }\n\n        client.parsed_middleware.handle([event_name, event_arg, client], function (err) {\n          if (err) {\n            console.error(err.stack);\n            return;\n          }\n\n          client.emit(event_name, event_arg);\n        });\n      });\n    }\n  }, {\n    key: \"addCommandHandlerListeners\",\n    value: function addCommandHandlerListeners() {\n      var client = this;\n      var commands = this.command_handler;\n      commands.on('nick', function (event) {\n        if (client.user.nick === event.nick) {\n          // nicks starting with numbers are reserved for uuids\n          // we dont want to store these as they cannot be used\n          if (event.new_nick.match(/^\\d/)) {\n            return;\n          }\n\n          client.user.nick = event.new_nick;\n        }\n      });\n      commands.on('mode', function (event) {\n        if (client.user.nick === event.target) {\n          event.modes.forEach(function (mode) {\n            client.user.toggleModes(mode.mode);\n          });\n        }\n      });\n      commands.on('wholist', function (event) {\n        var thisUser = _.find(event.users, {\n          nick: client.user.nick\n        });\n\n        if (thisUser) {\n          client.user.username = thisUser.ident;\n          client.user.host = thisUser.hostname;\n        }\n      });\n      commands.on('registered', function (event) {\n        client.user.nick = event.nick;\n        client.connection.registeredSuccessfully();\n        client.emit('connected', event);\n      });\n      commands.on('displayed host', function (event) {\n        if (client.user.nick === event.nick) {\n          client.user.host = event.host;\n        }\n      }); // Don't let IRC ERROR command kill the node.js process if unhandled\n\n      commands.on('error', function (event) {});\n    }\n  }, {\n    key: \"registerToNetwork\",\n    value: function registerToNetwork() {\n      var webirc = this.options.webirc;\n\n      if (webirc) {\n        var address = String(webirc.address); // Prepend a zero to addresses that begin with colon (like ::1)\n        // as colon is using to denote last argument in IRC\n\n        if (address[0] === ':') {\n          address = '0' + address;\n        }\n\n        this.raw('WEBIRC', webirc.password, webirc.username, webirc.hostname, address, MessageTags.encode(webirc.options || {}, ' '));\n      }\n\n      this.raw('CAP LS 302');\n\n      if (this.options.password) {\n        this.raw('PASS', this.options.password);\n      }\n\n      this.raw('NICK', this.user.nick);\n      this.raw('USER', this.options.username, 0, '*', this.user.gecos);\n    }\n  }, {\n    key: \"startPeriodicPing\",\n    value: function startPeriodicPing() {\n      var that = this;\n      var timeout_timer = null;\n\n      if (that.options.ping_interval <= 0 || that.options.ping_timeout <= 0) {\n        return;\n      } // Constantly ping the server for lag and time syncing functions\n\n\n      function pingServer() {\n        that.ping();\n        that.connection.setTimeout(pingServer, that.options.ping_interval * 1000);\n      } // Data from the server was detected so restart the timeout\n\n\n      function resetPingTimeoutTimer() {\n        that.connection.clearTimeout(timeout_timer);\n        timeout_timer = that.connection.setTimeout(pingTimeout, that.options.ping_timeout * 1000);\n      }\n\n      function pingTimeout() {\n        that.debugOut('Ping timeout (' + that.options.ping_timeout + ' seconds)');\n        that.emit('ping timeout');\n        var end_msg = that.rawString('QUIT', 'Ping timeout (' + that.options.ping_timeout + ' seconds)');\n        that.connection.end(end_msg, true);\n      }\n\n      this.resetPingTimeoutTimer = resetPingTimeoutTimer;\n      that.connection.setTimeout(pingServer, that.options.ping_interval * 1000);\n    } // Gets overridden with a function in startPeriodicPing(). Only set here for completeness.\n\n  }, {\n    key: \"resetPingTimeoutTimer\",\n    value: function resetPingTimeoutTimer() {}\n  }, {\n    key: \"debugOut\",\n    value: function debugOut(out) {\n      this.emit('debug', 'Client ' + out);\n    }\n    /**\n     * Client API\n     */\n\n  }, {\n    key: \"raw\",\n    value: function raw(input) {\n      if (input instanceof IrcMessage) {\n        this.connection.write(input.to1459());\n      } else {\n        this.connection.write(this.rawString.apply(this, arguments));\n      }\n    }\n  }, {\n    key: \"rawString\",\n    value: function rawString(input) {\n      var args;\n\n      if (input.constructor === Array) {\n        args = input;\n      } else {\n        args = Array.prototype.slice.call(arguments, 0);\n      }\n\n      args = args.filter(function (item) {\n        return typeof item === 'number' || typeof item === 'string';\n      });\n\n      if (args.length > 1 && args[args.length - 1].match(/^:|\\s/)) {\n        args[args.length - 1] = ':' + args[args.length - 1];\n      }\n\n      return args.join(' ');\n    }\n  }, {\n    key: \"quit\",\n    value: function quit(message) {\n      this.connection.end(this.rawString('QUIT', message));\n    }\n  }, {\n    key: \"ping\",\n    value: function ping(message) {\n      this.raw('PING', message || 'kiwitime-' + Date.now());\n    }\n  }, {\n    key: \"changeNick\",\n    value: function changeNick(nick) {\n      this.raw('NICK', nick);\n    }\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(commandName, target, message) {\n      var _this2 = this;\n\n      var lines = message.split(/\\r\\n|\\n|\\r/).filter(function (i) {\n        return i;\n      });\n      lines.forEach(function (line) {\n        // Maximum length of target + message we can send to the IRC server is 500 characters\n        // but we need to leave extra room for the sender prefix so the entire message can\n        // be sent from the IRCd to the target without being truncated.\n        var blocks = _toConsumableArray(lineBreak(line, {\n          bytes: _this2.options.message_max_length,\n          allowBreakingWords: true,\n          allowBreakingGraphemes: true\n        }));\n\n        blocks.forEach(function (block) {\n          return _this2.raw(commandName, target, block);\n        });\n      });\n    }\n  }, {\n    key: \"say\",\n    value: function say(target, message) {\n      return this.sendMessage('PRIVMSG', target, message);\n    }\n  }, {\n    key: \"notice\",\n    value: function notice(target, message) {\n      return this.sendMessage('NOTICE', target, message);\n    }\n  }, {\n    key: \"tagmsg\",\n    value: function tagmsg(target) {\n      var tags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var msg = new IrcMessage('TAGMSG', target);\n      msg.tags = tags;\n      this.raw(msg);\n    }\n  }, {\n    key: \"join\",\n    value: function join(channel, key) {\n      var raw = ['JOIN', channel];\n\n      if (key) {\n        raw.push(key);\n      }\n\n      this.raw(raw);\n    }\n  }, {\n    key: \"part\",\n    value: function part(channel, message) {\n      var raw = ['PART', channel];\n\n      if (message) {\n        raw.push(message);\n      }\n\n      this.raw(raw);\n    }\n  }, {\n    key: \"mode\",\n    value: function mode(channel, _mode, extra_args) {\n      var raw = ['MODE', channel, _mode];\n\n      if (extra_args) {\n        if (Array.isArray(extra_args)) {\n          raw = raw.concat(extra_args);\n        } else {\n          raw.push(extra_args);\n        }\n      }\n\n      this.raw(raw);\n    }\n  }, {\n    key: \"inviteList\",\n    value: function inviteList(channel, cb) {\n      var client = this;\n      var invex = this.network.supports('INVEX');\n      var mode = 'I';\n\n      if (typeof invex === 'string' && invex) {\n        mode = invex;\n      }\n\n      function onInviteList(event) {\n        if (event.channel.toLowerCase() === channel.toLowerCase()) {\n          unbindEvents();\n\n          if (typeof cb === 'function') {\n            cb(event);\n          }\n        }\n      }\n\n      function onInviteListErr(event) {\n        if (event.error === 'chanop_privs_needed') {\n          unbindEvents();\n\n          if (typeof cb === 'function') {\n            cb(null);\n          }\n        }\n      }\n\n      function bindEvents() {\n        client.on('inviteList', onInviteList);\n        client.on('irc error', onInviteListErr);\n      }\n\n      function unbindEvents() {\n        client.removeListener('inviteList', onInviteList);\n        client.removeListener('irc error', onInviteListErr);\n      }\n\n      bindEvents();\n      this.raw(['MODE', channel, mode]);\n    }\n  }, {\n    key: \"invite\",\n    value: function invite(channel, nick) {\n      var raw = ['INVITE', nick, channel];\n      this.raw(raw);\n    }\n  }, {\n    key: \"addInvite\",\n    value: function addInvite(channel, mask) {\n      var mode = 'I';\n      var invex = this.network.supports('INVEX');\n\n      if (typeof invex === 'string') {\n        mode = invex;\n      }\n\n      var raw = ['MODE', channel, '+' + mode, mask];\n      this.raw(raw);\n    }\n  }, {\n    key: \"removeInvite\",\n    value: function removeInvite(channel, mask) {\n      var mode = 'I';\n      var invex = this.network.supports('INVEX');\n\n      if (typeof invex === 'string') {\n        mode = invex;\n      }\n\n      var raw = ['MODE', channel, '-' + mode, mask];\n      this.raw(raw);\n    }\n  }, {\n    key: \"banlist\",\n    value: function banlist(channel, cb) {\n      var client = this;\n      var raw = ['MODE', channel, 'b'];\n      this.on('banlist', function onBanlist(event) {\n        if (event.channel.toLowerCase() === channel.toLowerCase()) {\n          client.removeListener('banlist', onBanlist);\n\n          if (typeof cb === 'function') {\n            cb(event);\n          }\n        }\n      });\n      this.raw(raw);\n    }\n  }, {\n    key: \"ban\",\n    value: function ban(channel, mask) {\n      var raw = ['MODE', channel, '+b', mask];\n      this.raw(raw);\n    }\n  }, {\n    key: \"unban\",\n    value: function unban(channel, mask) {\n      var raw = ['MODE', channel, '-b', mask];\n      this.raw(raw);\n    }\n  }, {\n    key: \"setTopic\",\n    value: function setTopic(channel, newTopic) {\n      this.raw('TOPIC', channel, newTopic);\n    }\n  }, {\n    key: \"ctcpRequest\",\n    value: function ctcpRequest(target, type\n    /*, paramN */\n    ) {\n      var params = Array.prototype.slice.call(arguments, 1); // make sure the CTCP type is uppercased\n\n      params[0] = params[0].toUpperCase();\n      this.raw('PRIVMSG', target, String.fromCharCode(1) + params.join(' ') + String.fromCharCode(1));\n    }\n  }, {\n    key: \"ctcpResponse\",\n    value: function ctcpResponse(target, type\n    /*, paramN */\n    ) {\n      var params = Array.prototype.slice.call(arguments, 1); // make sure the CTCP type is uppercased\n\n      params[0] = params[0].toUpperCase();\n      this.raw('NOTICE', target, String.fromCharCode(1) + params.join(' ') + String.fromCharCode(1));\n    }\n  }, {\n    key: \"action\",\n    value: function action(target, message) {\n      var that = this; // Maximum length of target + message we can send to the IRC server is 500 characters\n      // but we need to leave extra room for the sender prefix so the entire message can\n      // be sent from the IRCd to the target without being truncated.\n      // The block length here is the max, but without the non-content characters:\n      // the command name, the space, and the two SOH chars\n\n      var commandName = 'ACTION';\n      var blockLength = this.options.message_max_length - (commandName.length + 3);\n\n      var blocks = _toConsumableArray(lineBreak(message, {\n        bytes: blockLength,\n        allowBreakingWords: true,\n        allowBreakingGraphemes: true\n      }));\n\n      blocks.forEach(function (block) {\n        that.ctcpRequest(target, commandName, block);\n      });\n      return blocks;\n    }\n  }, {\n    key: \"whois\",\n    value: function whois(target, _cb) {\n      var client = this;\n      var cb;\n      var irc_args = ['WHOIS']; // Support whois(target, arg1, arg2, argN, cb)\n\n      _.each(arguments, function (arg) {\n        if (typeof arg === 'function') {\n          cb = arg;\n        } else {\n          irc_args.push(arg);\n        }\n      });\n\n      this.on('whois', function onWhois(event) {\n        if (event.nick.toLowerCase() === target.toLowerCase()) {\n          client.removeListener('whois', onWhois);\n\n          if (typeof cb === 'function') {\n            cb(event);\n          }\n        }\n      });\n      this.raw(irc_args);\n    }\n  }, {\n    key: \"whowas\",\n    value: function whowas(target, _cb) {\n      var client = this;\n      var cb;\n      var irc_args = ['WHOWAS']; // Support whowas(target, arg1, arg2, argN, cb)\n\n      _.each(arguments, function (arg) {\n        if (typeof arg === 'function') {\n          cb = arg;\n        } else {\n          irc_args.push(arg);\n        }\n      });\n\n      this.on('whowas', function onWhowas(event) {\n        if (event.nick.toLowerCase() === target.toLowerCase()) {\n          client.removeListener('whowas', onWhowas);\n\n          if (typeof cb === 'function') {\n            cb(event);\n          }\n        }\n      });\n      this.raw(irc_args);\n    }\n    /**\n     * WHO requests are queued up to run serially.\n     * This is mostly because networks will only reply serially and it makes\n     * it easier to include the correct replies to callbacks\n     */\n\n  }, {\n    key: \"who\",\n    value: function who(target, cb) {\n      if (!this.who_queue) {\n        this.who_queue = [];\n      }\n\n      this.who_queue.push([target, cb]);\n      this.processNextWhoQueue();\n    }\n  }, {\n    key: \"processNextWhoQueue\",\n    value: function processNextWhoQueue() {\n      var client = this; // No items in the queue or the queue is already running?\n\n      if (client.who_queue.length === 0 || client.who_queue.is_running) {\n        return;\n      }\n\n      client.who_queue.is_running = true;\n      var this_who = client.who_queue.shift();\n      var target = this_who[0];\n      var cb = this_who[1];\n\n      if (!target || typeof target !== 'string') {\n        if (typeof cb === 'function') {\n          _.defer(cb, {\n            target: target,\n            users: []\n          });\n        } // Start the next queued WHO request\n\n\n        client.who_queue.is_running = false;\n\n        _.defer(_.bind(client.processNextWhoQueue, client));\n\n        return;\n      }\n\n      client.on('wholist', function onWho(event) {\n        client.removeListener('wholist', onWho); // Start the next queued WHO request\n\n        client.who_queue.is_running = false;\n\n        _.defer(_.bind(client.processNextWhoQueue, client));\n\n        if (typeof cb === 'function') {\n          cb({\n            target: target,\n            users: event.users\n          });\n        }\n      });\n\n      if (client.network.supports('whox')) {\n        client.raw('WHO', target, '%cuhsnfdaor');\n      } else {\n        client.raw('WHO', target);\n      }\n    }\n    /**\n     * Explicitely start a channel list, avoiding potential issues with broken IRC servers not sending RPL_LISTSTART\n     */\n\n  }, {\n    key: \"list\",\n    value: function list()\n    /* paramN */\n    {\n      var args = Array.prototype.slice.call(arguments);\n      this.command_handler.cache('chanlist').channels = [];\n      args.unshift('LIST');\n      this.raw(args);\n    }\n  }, {\n    key: \"channel\",\n    value: function channel(channel_name) {\n      return new Channel(this, channel_name);\n    }\n  }, {\n    key: \"match\",\n    value: function match(match_regex, cb, message_type) {\n      var client = this;\n\n      var onMessage = function onMessage(event) {\n        if (event.message.match(match_regex)) {\n          cb(event);\n        }\n      };\n\n      this.on(message_type || 'message', onMessage);\n      return {\n        stop: function stop() {\n          client.removeListener(message_type || 'message', onMessage);\n        }\n      };\n    }\n  }, {\n    key: \"matchNotice\",\n    value: function matchNotice(match_regex, cb) {\n      return this.match(match_regex, cb, 'notice');\n    }\n  }, {\n    key: \"matchMessage\",\n    value: function matchMessage(match_regex, cb) {\n      return this.match(match_regex, cb, 'privmsg');\n    }\n  }, {\n    key: \"matchAction\",\n    value: function matchAction(match_regex, cb) {\n      return this.match(match_regex, cb, 'action');\n    }\n  }, {\n    key: \"Message\",\n    get: function get() {\n      return IrcMessage;\n    }\n  }], [{\n    key: \"setDefaultTransport\",\n    value: function setDefaultTransport(transport) {\n      default_transport = transport;\n    }\n  }]);\n\n  return IrcClient;\n}(EventEmitter);"],"sourceRoot":""}